---
name: Unit Test Checks
applies_when: Changed files include .test.ts or .spec.ts files
---

- [ ] **Style guide adherence**: Test files must follow the conventions in `.ai/UnitTestGeneration.md`. Key rules to verify: method under test is executed in `beforeEach()` with assertions only in `it()` blocks (Critical Rule #1), mock behavior is configured in `beforeEach`/`beforeAll` and never at module level (Critical Rule #2), callbacks are invoked via `mockImplementation` and never via `mock.calls[N][M]()` (Critical Rule #3). Also check for coverage-driven test planning (every branch in the source has a corresponding test scenario) and superfluous test prevention (no duplicate scenarios exercising the same code path with different literal values). Note: the guide's suggestion to use "fun" test data is optional — straightforward data is equally acceptable.
- [ ] **No testing pure style hooks**: Do not test hooks that simply export a memoized style object or return static style values (e.g., `useStyles`, `useTheme` wrappers that just return a `useMemo` around a style object). If the hook contains conditional logic, branching, or computation that determines _which_ styles to return based on props/state, it should be tested. The distinction: does the hook have code paths a reviewer would want coverage on, or is it just a memoized constant?
- [ ] **No testing barrel exports**: Flag any new test file that tests an `index.ts` barrel export file (a file whose only purpose is re-exporting from other modules). These files have zero logic and zero branches — testing them adds maintenance cost with no coverage value.
- [ ] **Test descriptions match assertions**: Flag `describe`/`it` blocks where the text description doesn't match what the `expect` statements actually verify. For example, `it("should return the user")` followed by `expect(mockLogger.warn).toHaveBeenCalled()` is a mismatch — the description claims one behavior but the assertion checks something unrelated. Descriptions should accurately predict what the assertions verify.
- [ ] **Missing `export default {}`**: Every test file must include `export default {};` near the top of the file (after any eslint pragma comments). This prevents global scope collision between test files. Flag any new or modified test file missing this export — the resulting failures are cryptic and hard to trace back to this cause.
